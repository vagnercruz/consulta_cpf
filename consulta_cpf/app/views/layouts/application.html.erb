<!DOCTYPE html>
<html lang="pt-br" data-theme="light">
<head>
  <meta charset="UTF-8">
  <title>Consulta de CPF</title>

  <%= csrf_meta_tags %>
  <%= csp_meta_tag %>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>

  <style>
    /* √çcones animados */
    .theme-btn {
      cursor: pointer;
      font-size: 22px;
      padding: 6px 12px;
      border-radius: 10px;
      transition: background 0.3s ease;
      user-select: none;
    }

    .theme-btn:hover {
      background: rgba(0,0,0,0.06);
    }

    :root[data-theme='dark'] .theme-btn:hover {
      background: rgba(255,255,255,0.1);
    }

    .theme-selector {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .theme-mode {
      padding: 4px 10px;
      border-radius: 8px;
      cursor: pointer;
      border: 1px solid var(--primary);
      transition: 0.3s;
    }

    .theme-mode.active {
      background: var(--primary);
      color: white;
    }
  </style>

  <script>
    function applyTheme(theme) {
      if (theme === "auto") {
        const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        document.documentElement.setAttribute("data-theme", prefersDark ? "dark" : "light");
      } else {
        document.documentElement.setAttribute("data-theme", theme);
      }
    }

    document.addEventListener("DOMContentLoaded", function () {
      const savedTheme = localStorage.getItem("theme") || "auto";
      applyTheme(savedTheme);

      // Marca o bot√£o ativo
      document.querySelectorAll(".theme-mode").forEach(btn => {
        if (btn.dataset.mode === savedTheme) btn.classList.add("active");
      });
    });

    function setTheme(mode) {
      localStorage.setItem("theme", mode);

      document.querySelectorAll(".theme-mode").forEach(btn => btn.classList.remove("active"));
      document.querySelector(`[data-mode='${mode}']`).classList.add("active");

      applyTheme(mode);
    }
  </script>

</head>

<body>
  <nav class="p-3 d-flex justify-content-between align-items-center shadow-sm" style="background: var(--card);">
    <h3 class="m-0">üîç Consulta CPF</h3>

    <div class="theme-selector">
      <div class="theme-mode" data-mode="light" onclick="setTheme('light')">‚òÄÔ∏è Claro</div>
      <div class="theme-mode" data-mode="dark" onclick="setTheme('dark')">üåô Escuro</div>
      <div class="theme-mode" data-mode="auto" onclick="setTheme('auto')">üñ•Ô∏è Auto</div>
    </div>
  </nav>

  <div class="container mt-5 mb-5">
    <%= yield %>
  </div>

</body>
</html>
